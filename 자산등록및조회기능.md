# 자산 등록 및 조회 기능

## 구현된 기능

### 데이터베이스

- ownership_claims: 자산 승인 신청 정보
- ownership_documents: 첨부 서류 관리
- 지도 연동을 위한 위치 정보 (위도, 경도, 주소)

### 백엔드

- OwnershipClaimController: REST API
- OwnershipClaimService: 비즈니스 로직 처리
- FileStorageService: 파일 업로드 처리
- MapApiService: 지도 API 연동 (준비됨)

### 엔티티

- OwnershipClaim: 자산 승인 신청
- OwnershipDocument: 첨부 문서
- 관련 DTO 클래스들

## 연동 방법

### 인증 시스템 연동

현재는 userId를 직접 받고 있지만, 실제 로그인 시스템과 연동할 때는 다음과 같이 수정:

```java
// 현재
@PostMapping("/claims")
public OwnershipClaimResponse createClaim(@RequestParam("userId") Long userId, ...)

// 연동 후
@PostMapping("/claims")
public OwnershipClaimResponse createClaim(@AuthenticationPrincipal UserDetails user, ...)
```

### 지도 API 연동

MapApiService에 실제 지도 API 연동하면 됨:

- 카카오맵, 네이버맵, 구글맵 중 선택
- API 키 설정
- 좌표-주소 변환 기능 구현

### 필요한 화면

1. 자산 등록 페이지

   - 지도에서 위치 클릭
   - 기본 정보 입력 (이름, 연락처, 관계)
   - 서류 첨부 (등기부등본, 신분증 등)

2. 내 자산 목록 페이지

   - 신청 내역 조회
   - 상태별 필터 (대기중/승인/거절)

3. 관리자 페이지
   - 모든 신청 목록
   - 승인/거절 처리

## API 목록

### 사용자 API

- POST /api/ownership/claims - 자산 등록 신청 (파일 첨부)
- GET /api/ownership/my-claims/{userId} - 내 신청 목록
- GET /api/ownership/claims/{claimId} - 신청 상세 조회
- GET /api/ownership/documents/{id}/download - 서류 다운로드

### 관리자 API

- GET /api/ownership/admin/claims - 모든 신청 조회
- GET /api/ownership/admin/claims/{claimId} - 신청 상세 조회
- POST /api/ownership/admin/claims/{claimId}/approve - 승인
- POST /api/ownership/admin/claims/{claimId}/reject - 거절

### 지도 API

- GET /api/ownership/map/address - 좌표로 주소 찾기
- GET /api/ownership/map/coordinates - 주소로 좌표 찾기
- GET /api/ownership/map/nearby-buildings - 주변 건물 검색

## 연동 체크리스트

### 인증 시스템

- [ ] JWT 또는 세션 기반 로그인 연동
- [ ] 사용자 정보 자동 추출
- [ ] 관리자 권한 체크

### 지도 API

- [ ] 지도 서비스 선택 (카카오맵/네이버맵/구글맵)
- [ ] API 키 발급
- [ ] MapApiService 실제 구현
- [ ] 프론트엔드 지도 SDK 연동

### 파일 업로드

- [ ] 파일 저장 경로 설정
- [ ] 파일 크기 제한
- [ ] 파일 타입 검증

### 프론트엔드

- [ ] UI 구현 (React/Vue 등)
- [ ] 지도 컴포넌트
- [ ] 파일 업로드 컴포넌트
- [ ] 상태 관리

## 배포 설정

### 환경 설정

```yaml
# application-prod.yml
app:
  file:
    upload-dir: /app/uploads/ownership

spring:
  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 50MB

map:
  api:
    kakao:
      key: ${KAKAO_MAP_API_KEY}
```

### 보안

- 파일 업로드 경로 보안
- API 키 환경변수 관리
- CORS 설정
- 파일 다운로드 권한 체크

### 성능

- 파일 저장소 (AWS S3 등)
- 이미지 리사이징
- 캐싱

## 참고사항

1. 현재 구현은 독립적으로 작동하도록 설계됨
2. 데이터베이스 스키마 그대로 사용 가능
3. RESTful API로 프론트엔드 연동 쉬움
4. 멀티파트 폼 데이터 지원
5. 지도 API 추상화로 어떤 서비스든 연동 가능

## 테스트

연동 후 테스트 항목:

1. 로그인 후 자산 등록 신청
2. 지도 위치 선택
3. 파일 업로드/다운로드
4. 관리자 승인/거절
5. 권한별 접근 제어
